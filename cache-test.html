<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ç¼“å­˜æµ‹è¯• - Cache Test</title>
    <meta http-equiv="Cache-Control" content="no-cache">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f0f8ff; }
        .test-box { background: white; padding: 20px; border-radius: 8px; margin: 10px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .success { border-left: 4px solid #4caf50; }
        .error { border-left: 4px solid #f44336; }
        .warning { border-left: 4px solid #ff9800; }
        button { padding: 10px 20px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; }
        .btn-primary { background: #2196f3; color: white; }
        .btn-success { background: #4caf50; color: white; }
    </style>
</head>
<body>
    <h1>ğŸ” ç¼“å­˜æµ‹è¯•é¡µé¢</h1>
    
    <div class="test-box">
        <h3>å½“å‰æ—¶é—´æµ‹è¯•</h3>
        <p>é¡µé¢ç”Ÿæˆæ—¶é—´: <span id="page-time"></span></p>
        <p>å¦‚æœæ¯æ¬¡åˆ·æ–°æ—¶é—´éƒ½å˜åŒ–ï¼Œè¯´æ˜æ²¡æœ‰ç¼“å­˜é—®é¢˜</p>
    </div>
    
    <div class="test-box">
        <h3>ä¸»é¡µè®¿é—®æµ‹è¯•</h3>
        <button class="btn-primary" onclick="testHomePage()">æµ‹è¯•ä¸»é¡µè®¿é—®</button>
        <button class="btn-primary" onclick="testWithTimestamp()">æµ‹è¯•å¸¦æ—¶é—´æˆ³è®¿é—®</button>
        <div id="test-result"></div>
    </div>
    
    <div class="test-box">
        <h3>ç¼“å­˜å¤´éƒ¨æ£€æµ‹</h3>
        <button class="btn-success" onclick="checkCacheHeaders()">æ£€æŸ¥ç¼“å­˜å¤´éƒ¨</button>
        <div id="cache-headers"></div>
    </div>
    
    <div class="test-box warning">
        <h3>âš ï¸ å¦‚æœä¸»é¡µä»è·³è½¬åˆ° index_new.html</h3>
        <p><strong>åŸå› ï¼š</strong>æœåŠ¡å™¨æˆ–CDNç¼“å­˜æœªæ¸…é™¤</p>
        <p><strong>è§£å†³ï¼š</strong></p>
        <ol>
            <li>ç­‰å¾…15-30åˆ†é’Ÿè®©ç¼“å­˜è‡ªåŠ¨è¿‡æœŸ</li>
            <li>è”ç³»æ‰˜ç®¡æœåŠ¡å•†æ¸…é™¤æœåŠ¡å™¨ç¼“å­˜</li>
            <li>å¦‚ä½¿ç”¨CDNï¼Œæ¸…é™¤CDNç¼“å­˜</li>
            <li>ä¸´æ—¶ä½¿ç”¨å¸¦æ—¶é—´æˆ³çš„URL</li>
        </ol>
    </div>

    <script>
        // æ˜¾ç¤ºé¡µé¢ç”Ÿæˆæ—¶é—´
        document.getElementById('page-time').textContent = new Date().toLocaleString('zh-CN');
        
        function testHomePage() {
            const result = document.getElementById('test-result');
            result.innerHTML = '<p>æ­£åœ¨æµ‹è¯•ä¸»é¡µè®¿é—®...</p>';
            
            // åœ¨æ–°çª—å£æµ‹è¯•ä¸»é¡µ
            const testWindow = window.open('/', '_blank');
            
            setTimeout(() => {
                if (testWindow && !testWindow.closed) {
                    if (testWindow.location.href.includes('index_new.html')) {
                        result.innerHTML = '<div class="test-box error"><strong>âŒ ä»ç„¶è·³è½¬åˆ° index_new.html</strong><br>éœ€è¦æ¸…é™¤æœåŠ¡å™¨ç¼“å­˜</div>';
                    } else {
                        result.innerHTML = '<div class="test-box success"><strong>âœ… ä¸»é¡µè®¿é—®æ­£å¸¸</strong></div>';
                    }
                    testWindow.close();
                }
            }, 2000);
        }
        
        function testWithTimestamp() {
            const timestamp = new Date().getTime();
            window.open(`/index.html?v=${timestamp}`, '_blank');
        }
        
        function checkCacheHeaders() {
            const result = document.getElementById('cache-headers');
            result.innerHTML = '<p>æ­£åœ¨æ£€æŸ¥ç¼“å­˜å¤´éƒ¨...</p>';
            
            fetch('/index.html', { method: 'HEAD' })
                .then(response => {
                    const headers = [];
                    headers.push(`Cache-Control: ${response.headers.get('cache-control') || 'æœªè®¾ç½®'}`);
                    headers.push(`Pragma: ${response.headers.get('pragma') || 'æœªè®¾ç½®'}`);
                    headers.push(`Expires: ${response.headers.get('expires') || 'æœªè®¾ç½®'}`);
                    headers.push(`ETag: ${response.headers.get('etag') || 'æœªè®¾ç½®'}`);
                    
                    result.innerHTML = `<pre>${headers.join('\n')}</pre>`;
                })
                .catch(error => {
                    result.innerHTML = '<p>æ— æ³•æ£€æŸ¥å¤´éƒ¨ä¿¡æ¯</p>';
                });
        }
    </script>
</body>
</html> 